<!DOCTYPE html>
<html xmlns='http://www.w3.org/1999/xhtml' lang='' xml:lang=''>
<head>
	<meta charset='utf-8' />
	<meta name='viewport' content='width=device-width, user-scalable=no' />
	<title>TerryTheWorker</title>
	<link rel="stylesheet" type="text/css" href="index.css" />
	<link id='-gd-engine-icon' rel='icon' type='image/png' href='index.icon.png' />
	<link rel='apple-touch-icon' href='index.apple-touch-icon.png'/>
</head>
<body>
	<img id="icon"/>
	<div id="vMenu">
		<a href="#top" class="buttons">
			GIOCA
		</a>
		<a href="#title" class="buttons">
			IL PROGETTO
		</a>
		<a class="buttons">
			IL TEAM
		</a>
	</div>
	<section class="section" id="game">
		<canvas id='canvas'>
			HTML5 canvas appears to be unsupported in the current browser.<br />
			Please try updating or use a different browser.
		</canvas>
		<div id='status'>
			<div id='status-progress' style='display: none;' oncontextmenu='event.preventDefault();'><div id ='status-progress-inner'></div></div>
			<div id='status-indeterminate' style='display: none;' oncontextmenu='event.preventDefault();'>
				<div></div>
				<div></div>
				<div></div>
				<div></div>
				<div></div>
				<div></div>
				<div></div>
				<div></div>
			</div>
			<div id='status-notice' class='godot' style='display: none;'></div>
		</div>

		<script type='text/javascript' src='index.js'></script>
		<script type='text/javascript'>//<![CDATA[

			const GODOT_CONFIG = {"args":[],"canvasResizePolicy":1,"executable":"index","experimentalVK":false,"fileSizes":{"index.pck":29100672,"index.wasm":17865444},"focusCanvas":true,"gdnativeLibs":[]};
			var engine = new Engine(GODOT_CONFIG);

			(function() {
				const INDETERMINATE_STATUS_STEP_MS = 100;
				var statusProgress = document.getElementById('status-progress');
				var statusProgressInner = document.getElementById('status-progress-inner');
				var statusIndeterminate = document.getElementById('status-indeterminate');
				var statusNotice = document.getElementById('status-notice');

				var initializing = true;
				var statusMode = 'hidden';

				var animationCallbacks = [];
				function animate(time) {
					animationCallbacks.forEach(callback => callback(time));
					requestAnimationFrame(animate);
				}
				requestAnimationFrame(animate);

				function setStatusMode(mode) {

					if (statusMode === mode || !initializing)
						return;
					[statusProgress, statusIndeterminate, statusNotice].forEach(elem => {
						elem.style.display = 'none';
					});
					animationCallbacks = animationCallbacks.filter(function(value) {
						return (value != animateStatusIndeterminate);
					});
					switch (mode) {
						case 'progress':
							statusProgress.style.display = 'block';
							break;
						case 'indeterminate':
							statusIndeterminate.style.display = 'block';
							animationCallbacks.push(animateStatusIndeterminate);
							break;
						case 'notice':
							statusNotice.style.display = 'block';
							break;
						case 'hidden':
							break;
						default:
							throw new Error('Invalid status mode');
					}
					statusMode = mode;
				}

				function animateStatusIndeterminate(ms) {
					var i = Math.floor(ms / INDETERMINATE_STATUS_STEP_MS % 8);
					if (statusIndeterminate.children[i].style.borderTopColor == '') {
						Array.prototype.slice.call(statusIndeterminate.children).forEach(child => {
							child.style.borderTopColor = '';
						});
						statusIndeterminate.children[i].style.borderTopColor = '#dfdfdf';
					}
				}

				function setStatusNotice(text) {
					while (statusNotice.lastChild) {
						statusNotice.removeChild(statusNotice.lastChild);
					}
					var lines = text.split('\n');
					lines.forEach((line) => {
						statusNotice.appendChild(document.createTextNode(line));
						statusNotice.appendChild(document.createElement('br'));
					});
				};

				function displayFailureNotice(err) {
					var msg = err.message || err;
					console.error(msg);
					setStatusNotice(msg);
					setStatusMode('notice');
					initializing = false;
				};

				if (!Engine.isWebGLAvailable()) {
					displayFailureNotice('WebGL not available');
				} else {
					setStatusMode('indeterminate');
					engine.startGame({
						'onProgress': function (current, total) {
							if (total > 0) {
								statusProgressInner.style.width = current/total * 100 + '%';
								setStatusMode('progress');
								if (current === total) {
									// wait for progress bar animation
									setTimeout(() => {
										setStatusMode('indeterminate');
									}, 500);
								}
							} else {
								setStatusMode('indeterminate');
							}
						},
					}).then(() => {
						setStatusMode('hidden');
						initializing = false;
					}, displayFailureNotice);
				}
			})();
		//]]></script>
	</section>
	<section class="section" id="info">
		<h1 id="title">IL PROGETTO</h1>
		<a class="prev" onclick="plusSlides(-1)">&#10094;</a>
  		<a class="next" onclick="plusSlides(1)">&#10095;</a>
		<div class="slides">
			<h2 id="slide2Title">Cos'e'?</h2>
			<p>
				“Terry the worker” e’ un videogioco platform a scorrimento orizzontale nel quale l’utente riveste i panni di Terry,
					un lavoratore che dopo un incidente sul luogo di lavoro dovra’ superare una serie di ostacoli e prove per salvarsi.
				Il gioco ha come tema principale la sicurezza sul lavoro, e ha come compito primario istruire il giocatore sulle adeguate misure di sicurezza da adottare
					in un ambiente lavorativo. L’utente infatti potra’ acquisire vari oggetti durante l’esperienza di gioco che amplieranno la sua conoscenza sui 
					dispositivi di protezione adatti.
			</p>
			<img src="Media/ezgif-7-dd5e9c60ef.gif" height="60px" width="50px"/>
		</div>
		<div class="slides">2</div>
		<div class="slides">3</div>
		<div class="slides">4</div>
	</section>
	<script src="utility.js"></script>
</body>
</html>

